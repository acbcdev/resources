---
/**
 * New Resources Page
 * Displays recently added resources
 * Linked from the "New" link in the sidebar
 */

import type { GetStaticPaths } from 'astro';
import { DATA } from '@/data';
import newUrls from '@/data/new.json';
import Layout from '@/layouts/Layout.astro';
import ListResources from '@/features/common/lists/ListResources.astro';
import { PAGES } from '@/features/common/consts/text';

export const getStaticPaths = (({ paginate }) => {
	// Filter DATA to only include resources that are in the new.json list
	const newUrlsSet = new Set(newUrls);
	const newResources = DATA.filter((resource) => newUrlsSet.has(resource.url));

	return paginate(newResources, {
		pageSize: 20,
	});
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<Layout title={PAGES.newResources.title}>
	<div class="new-resources-container">
		<div class="new-resources-header">
			<h1>{PAGES.newResources.heading}</h1>
			<p class="subtitle">{PAGES.newResources.subtitle}</p>
		</div>

		{
			page.data.length > 0 ? (
				<>
					<ListResources resources={page.data} />

					<div class="pagination-container">
						{/* Pagination will be added in future enhancement */}
					</div>
				</>
			) : (
				<div class="no-results">
					<p>{PAGES.newResources.noResults}</p>
				</div>
			)
		}
	</div>
</Layout>

<style>
	.new-resources-container {
		max-width: 1400px;
		margin: 0 auto;
	}

	.new-resources-header {
		margin-bottom: 2rem;
	}

	.new-resources-header h1 {
		font-size: 2.5rem;
		font-weight: bold;
		margin-bottom: 0.5rem;
		background: var(--accent-gradient);
		background-clip: text;
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
	}

	.subtitle {
		color: rgba(255, 255, 255, 0.6);
		font-size: 1.1rem;
	}

	.no-results {
		text-align: center;
		padding: 3rem 1rem;
		color: rgba(255, 255, 255, 0.7);
		font-size: 1.1rem;
	}

	.pagination-container {
		display: flex;
		justify-content: center;
		margin-top: 3rem;
		margin-bottom: 2rem;
	}
</style>
