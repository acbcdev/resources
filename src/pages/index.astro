---
import { DATA } from '@/data/index';
import Layout from '@/layouts/Layout.astro';
import { toHundreds } from '@/features/common/lib/utils';
import HeroCarousel from '@/features/common/homepage/HeroCarousel.astro';
import NewsGrid from '@/features/common/homepage/NewsGrid.astro';
import {
	getCarouselData,
	getNewResources,
	getFeaturedResources,
	getFeaturedCollections,
} from '@/features/common/homepage/lib/getFeaturedContent';

const numOfResources = toHundreds(DATA.length);

// Get carousel data
const carouselItems = getCarouselData();

// Get news grid data - mixed content
const newResources = getNewResources(6);
const featuredCollections = getFeaturedCollections(3);
const featuredResources = getFeaturedResources(3);

// Combine news items
const newsItems = [
	...newResources.map((d) => ({ type: 'resource' as const, data: d })),
	...featuredCollections.map((d) => ({ type: 'collection' as const, data: d })),
	...featuredResources.map((d) => ({ type: 'resource' as const, data: d })),
];

// Shuffle for variety
const shuffledNews = newsItems.sort(() => Math.random() - 0.5).slice(0, 12);
---

<Layout
	title={`Resources ${numOfResources}+ | Tools | Libraries | Illustrations | And More`}
	description="Discover and explore curated resources including tools, libraries, design assets, and learning materials for web development."
>
	<HeroCarousel items={carouselItems} />
	<NewsGrid items={shuffledNews} />
</Layout>
