---
import type { HTMLAttributes } from "astro/types";
import { tv, type VariantProps } from "tailwind-variants";

interface Props extends HTMLAttributes<"div">, VariantProps<typeof cardSkeleton> {}

export const cardSkeleton = tv({
	base: "bg-card rounded-xl border border-border/50 overflow-hidden animate-pulse",
	variants: {
		variant: {
			resource: "",
			compact: "flex items-center gap-4 p-4",
			feature: "p-6",
		},
	},
	defaultVariants: { variant: "resource" },
});

export const skeletonBlock = tv({
	base: "bg-muted rounded",
	variants: {
		size: {
			xs: "h-2",
			sm: "h-3",
			md: "h-4",
			lg: "h-6",
			xl: "h-8",
		},
		width: {
			full: "w-full",
			"3/4": "w-3/4",
			"2/3": "w-2/3",
			"1/2": "w-1/2",
			"1/3": "w-1/3",
			"1/4": "w-1/4",
		},
	},
	defaultVariants: { size: "md", width: "full" },
});

const { variant, class: className, ...rest } = Astro.props;
---

{
	variant === "resource" && (
		<div class={cardSkeleton({ variant, class: className })} data-slot="card-skeleton" {...rest}>
			{/* Image skeleton */}
			<div class="aspect-[16/10] bg-muted" />
			{/* Body skeleton */}
			<div class="p-4 space-y-3">
				<div class="flex items-center gap-2">
					<div class="size-8 rounded-lg bg-muted" />
					<div class="space-y-1.5 flex-1">
						<div class={skeletonBlock({ size: "md", width: "1/2" })} />
						<div class={skeletonBlock({ size: "xs", width: "1/3" })} />
					</div>
				</div>
				<div class="flex gap-1.5">
					<div class={skeletonBlock({ size: "lg", width: "1/4" })} />
					<div class={skeletonBlock({ size: "lg", width: "1/4" })} />
				</div>
				<div class={skeletonBlock({ size: "sm", width: "full" })} />
				<div class={skeletonBlock({ size: "sm", width: "3/4" })} />
			</div>
		</div>
	)
}

{
	variant === "compact" && (
		<div class={cardSkeleton({ variant, class: className })} data-slot="card-skeleton" {...rest}>
			<div class="size-12 rounded-xl bg-muted flex-shrink-0" />
			<div class="flex-1 space-y-2">
				<div class={skeletonBlock({ size: "md", width: "1/2" })} />
				<div class={skeletonBlock({ size: "sm", width: "2/3" })} />
			</div>
			<div class={skeletonBlock({ size: "lg", width: "1/4" })} />
		</div>
	)
}

{
	variant === "feature" && (
		<div class={cardSkeleton({ variant, class: className })} data-slot="card-skeleton" {...rest}>
			<div class={skeletonBlock({ size: "lg", width: "1/4" })} />
			<div class="mt-4 space-y-2">
				<div class={skeletonBlock({ size: "xl", width: "2/3" })} />
				<div class={skeletonBlock({ size: "sm", width: "full" })} />
				<div class={skeletonBlock({ size: "sm", width: "3/4" })} />
			</div>
			<div class={skeletonBlock({ size: "md", width: "1/3" })} style="margin-top: 1rem" />
		</div>
	)
}
