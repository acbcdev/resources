---
import { Image } from 'astro:assets';
import { ExternalLink } from 'lucide-react';
import {
	Card,
	CardContent,
	CardDescription,
	CardFooter,
	CardTitle,
} from '@/features/ui/card';
import { slugify } from '@/features/common/lib/utils';

type Props = {
	link: string;
	name: string;
	description: string;
	ogImage: string;
	ogDescription?: string;
	image?: string;
	icon?: string;
	tags?: string[];
};
const { link, name, description, ogImage, image, icon, ogDescription, tags } = Astro.props;

// Extract first letter for badge
const firstLetter = name.charAt(0).toUpperCase();
---

<Card variant="interactive" className="group/card overflow-hidden relative">
	<a target="_blank" aria-label={`${name} link`} href={link} class="relative block">
		{/* Letter Badge */}
		<div class="absolute top-3 left-3 z-10 size-10 rounded-full bg-primary text-primary-foreground font-bold text-lg flex items-center justify-center">
			{firstLetter}
		</div>
		<Image
			class="group-hover/card:scale-[1.02] w-full duration-200 text-center object-cover aspect-video z-0"
			src={ogImage || image || icon}
			loading="lazy"
			width={500}
			height={300}
			alt={ogDescription || description}
		/>
	</a>
	<CardContent className="flex flex-row items-center justify-between mt-4 sm:px-3">
		<CardTitle className="hover:text-foreground max-w-[90%] break-words hyphens-auto" lang="en">
			{name}
		</CardTitle>
		<a
			target="_blank"
			aria-label={`${name} link`}
			href={link}
			class="text-muted-foreground hover:text-foreground transition-colors"
		>
			<ExternalLink class="size-5" />
		</a>
	</CardContent>
	<CardFooter className="grid">
		<CardDescription className="text-base text-muted-foreground mb-2">
			{ogDescription ?? description}
		</CardDescription>
		<div class="flex flex-wrap gap-x-2">
			{
				tags?.map((tag) => {
					const fixTag = slugify(tag);
					return (
						<a
							href={`/tags/${fixTag}/1`}
							class="text-sm text-muted-foreground hover:underline hover:text-foreground transition-colors"
						>
							#{tag}
						</a>
					);
				})
			}
		</div>
	</CardFooter>
</Card>
