---
import type { HTMLAttributes } from "astro/types";
import { tv, type VariantProps } from "tailwind-variants";

type Props = Omit<HTMLAttributes<"input">, "type"> & VariantProps<typeof searchInput>;

export const searchInput = tv({
	base: [
		"border-input bg-input text-foreground w-full rounded-lg border pl-10 pr-4",
		"starwind-transition-colors",
		"focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",
		"disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-muted",
		"placeholder:text-muted-foreground",
	],
	variants: {
		size: {
			sm: "h-9 text-sm",
			md: "h-11 text-base",
			lg: "h-12 text-lg",
		},
		error: {
			true: "border-destructive focus:border-destructive focus:ring-destructive",
			false: "",
		},
	},
	defaultVariants: { size: "md", error: false },
});

export const searchInputWrapper = tv({
	base: "relative w-full",
});

export const searchInputIcon = tv({
	base: "absolute left-3 top-1/2 -translate-y-1/2 size-5 text-muted-foreground pointer-events-none",
	variants: {
		error: {
			true: "text-destructive",
			false: "",
		},
	},
	defaultVariants: { error: false },
});

const { size, error, class: className, ...rest } = Astro.props;
---

<div class={searchInputWrapper()}>
	<svg
		class={searchInputIcon({ error })}
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 24 24"
		fill="none"
		stroke="currentColor"
		stroke-width="2"
		stroke-linecap="round"
		stroke-linejoin="round"
	>
		<circle cx="11" cy="11" r="8"></circle>
		<path d="m21 21-4.3-4.3"></path>
	</svg>
	<input
		type="search"
		class={searchInput({ size, error, class: className })}
		data-slot="search-input"
		aria-invalid={error ? "true" : undefined}
		{...rest}
	/>
</div>
